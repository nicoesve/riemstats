---
title: "riemstats"
author: "Nicolas Escobar, Jaroslaw Harezlak"
date: "2025-02-12"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{riemstats}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The `riemstats` package provides specialized statistical methods for analyzing brain connectivity matrices (connectomes) from multi-site neuroimaging studies. When working with functional or structural connectivity data represented as symmetric positive definite (SPD) matrices, this package offers both harmonization techniques to address site-specific effects and ANOVA methods that respect the Riemannian geometry of SPD matrices.

## The Multi-Site Connectome Challenge

Modern neuroimaging studies often collect brain connectivity data across multiple sites to increase sample size and generalizability. However, this introduces significant challenges:

- **Site effects**: Different scanners, protocols, and populations introduce systematic biases
- **Non-Euclidean data**: Connectivity matrices are SPD matrices that lie on a curved manifold
- **Nested structure**: Data naturally groups into sites (batches) and biological conditions

Traditional statistical methods fail to address these challenges simultaneously, either ignoring the geometric structure of SPD matrices or lacking appropriate harmonization capabilities.

## Core Capabilities

`riemstats` addresses these challenges through two complementary approaches:

1. **Harmonization Methods**: Remove unwanted site/scanner effects while preserving biological signals
   - ComBat harmonization adapted for SPD matrices
   - Rigid geometric alignment methods
   - Flexible normalization strategies

2. **Riemannian ANOVA**: Test for group differences while respecting SPD geometry
   - Wilks' lambda and Pillai's trace statistics on the tangent space
   - Fr√©chet ANOVA using Riemannian distances
   - Bootstrap inference for robust significance testing

## Typical Workflow

This package is designed for the common neuroimaging analysis pipeline where researchers:
1. Collect connectivity matrices from multiple sites/scanners
2. Need to remove site-specific technical variation
3. Want to test for group differences (e.g., patients vs. controls)
4. Require methods that properly handle the SPD nature of connectivity matrices

By integrating harmonization and ANOVA within a Riemannian framework, `riemstats` enables rigorous statistical analysis of multi-site connectome data while preserving the geometric properties that make these matrices meaningful representations of brain connectivity.

